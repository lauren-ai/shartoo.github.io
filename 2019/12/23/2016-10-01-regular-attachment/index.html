<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>深度学习：参数正则化参考资料 | Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="deep learning基础">
<meta property="og:type" content="article">
<meta property="og:title" content="深度学习：参数正则化参考资料">
<meta property="og:url" content="http://shartoo.github.com/2019/12/23/2016-10-01-regular-attachment/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:description" content="deep learning基础">
<meta property="og:locale" content="en_US">
<meta property="og:image" content="http://shartoo.github.com/images/blog/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A51.jpg">
<meta property="article:published_time" content="2019-12-23T10:45:59.342Z">
<meta property="article:modified_time" content="2019-12-23T09:55:14.202Z">
<meta property="article:author" content="shartoo">
<meta name="twitter:card" content="summary">
<meta name="twitter:image" content="http://shartoo.github.com/images/blog/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A51.jpg">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  
<link rel="stylesheet" href="/css/style.css">

<meta name="generator" content="Hexo 4.2.0"></head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://shartoo.github.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main"><article id="post-2016-10-01-regular-attachment" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2019/12/23/2016-10-01-regular-attachment/" class="article-date">
  <time datetime="2019-12-23T10:45:59.342Z" itemprop="datePublished">2019-12-23</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/blog/">blog</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      深度学习：参数正则化参考资料
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="Hessian矩阵"><a href="#Hessian矩阵" class="headerlink" title="Hessian矩阵"></a>Hessian矩阵</h2><p> 是一个多元函数的二阶偏导数构成的方阵，描述了函数的局部曲率。若多元函数在临界点处一阶导数为0，此时仅仅通过一阶导数无法判断是极大值还是极小值，此时通过Hessian矩阵</p>
<ul>
<li><p>若$H(m)$是正定矩阵，则M处为局部极大值。</p>
</li>
<li><p>若$H(m)$是负定矩阵，则M处为局部极小值。</p>
</li>
<li><p>若$H(m)$是不定矩阵，则M处不是极值。</p>
</li>
</ul>
<h2 id="泰勒级数"><a href="#泰勒级数" class="headerlink" title="泰勒级数"></a>泰勒级数</h2><p>泰勒级数（英语：Taylor series）用无限项连加式——级数来表示一个函数，这些相加的项由函数在某一点的导数求得。如果  在点 $x=x_0$ 具有任意阶导数，则幂级数</p>
<p>$$<br>\sum_{n=0}^{\infty}\frac{f^{(n)}(x_0)}{n!}(x-x_0)^n=f(x_0)+f’(x_0)(x-x_0)+\frac{f’’(x_0))}{2!}(x-x_0)^2+…<br>$$</p>
<p>称为在点 $x_0$ 处的泰勒级数</p>
<h2 id="拉格朗日乘子和KKT条件"><a href="#拉格朗日乘子和KKT条件" class="headerlink" title="拉格朗日乘子和KKT条件"></a>拉格朗日乘子和KKT条件</h2><p>在求取有约束条件的优化问题时，拉格朗日乘子法（Lagrange Multiplier) 和KKT条件是非常重要的两个求取方法，对于等式约束的优化问题，可以应用拉格朗日乘子法去求取最优值；如果含有不等式约束，可以应用KKT条件去求取。当然，这两个方法求得的结果只是必要条件，只有当是凸函数的情况下，才能保证是充分必要条件。KKT条件是拉格朗日乘子法的泛化。之前学习的时候，只知道直接应用两个方法，但是却不知道为什么拉格朗日乘子法（Lagrange Multiplier) 和KKT条件能够起作用，为什么要这样去求取最优值呢？</p>
<p>下面将首先把什么是拉格朗日乘子法（Lagrange Multiplier) 和KKT条件叙述一下；然后开始分别谈谈为什么要这样求最优值。</p>
<h3 id="一-拉格朗日乘子法（Lagrange-Multiplier-和KKT条件"><a href="#一-拉格朗日乘子法（Lagrange-Multiplier-和KKT条件" class="headerlink" title="一. 拉格朗日乘子法（Lagrange Multiplier) 和KKT条件"></a>一. 拉格朗日乘子法（Lagrange Multiplier) 和KKT条件</h3><p>通常我们需要求解的最优化问题有如下几类：</p>
<p>1.无约束优化问题，可以写为:</p>
<p>$$<br>                    min f(x);<br>$$</p>
<p>2.有等式约束的优化问题，可以写为:</p>
<p>$$</p>
<pre><code>min f(x), \\
s.t. h_i(x) = 0;i =1, ..., n</code></pre><p>$$                                    </p>
<p>3.有不等式约束的优化问题，可以写为：</p>
<p>$$<br>    min f(x), \<br>    s.t. g_i(x) &lt;= 0; i =1, …, n\<br>    h_j(x) = 0; j =1, …, m<br>$$</p>
<p>对于第(1)类的优化问题，常常使用的方法就是Fermat定理，即使用求取f(x)的导数，然后令其为零，可以求得候选最优值，再在这些候选值中验证；如果是凸函数，可以保证是最优解。</p>
<p>对于第(2)类的优化问题，常常使用的方法就是拉格朗日乘子法（Lagrange Multiplier) ，即把等式约束 $h_i(x)$ 用一个系数与 $f(x)$ 写为一个式子，称为拉格朗日函数，而系数称为拉格朗日乘子。通过拉格朗日函数对各个变量求导，令其为零，可以求得候选值集合，然后验证求得最优值。</p>
<p>对于第(3)类的优化问题，常常使用的方法就是KKT条件。同样地，我们把所有的等式、不等式约束与f(x)写为一个式子，也叫拉格朗日函数，系数也称拉格朗日乘子，通过一些条件，可以求出最优值的必要条件，这个条件称为KKT条件。</p>
<ul>
<li><p><strong>拉格朗日乘子法（Lagrange Multiplier):</strong> 对于等式约束，我们可以通过一个拉格朗日系数a 把等式约束和目标函数组合成为一个式子 $L(a, x) = f(x) + a*h(x)$, 这里把a和 $h(x)$ 视为向量形式，a是横向量，h(x)为列向量。然后求取最优值，可以通过对 $L(a,x)$ 对各个参数求导取零，联立等式进行求取，这个在高等数学里面有讲，但是没有讲为什么这么做就可以，在后面，将简要介绍其思想。</p>
</li>
<li><p><strong>KKT条件:</strong> 对于含有不等式约束的优化问题，如何求取最优值呢？常用的方法是KKT条件，同样地，把所有的不等式约束、等式约束和目标函数全部写为一个式子 $L(a,b,x)=f(x)+a<em>g(x)+b</em>h(x)$ ，KKT条件是说最优值必须满足以下条件：</p>
<ol>
<li><p>$L(a, b, x)$ 对 $x$ 求导为零</p>
</li>
<li><p>$h(x) =0$</p>
</li>
<li><p>$a*g(x) = 0$</p>
</li>
</ol>
<p>求取这三个等式之后就能得到候选最优值。其中第三个式子非常有趣，因为$g(x)&lt;=0$，如果要满足这个等式，必须$a=0$或者$g(x)=0$ . 这是SVM的很多重要性质的来源，如支持向量的概念。</p>
</li>
</ul>
<h3 id="二-为什么拉格朗日乘子法（Lagrange-Multiplier-和KKT条件能够得到最优值？"><a href="#二-为什么拉格朗日乘子法（Lagrange-Multiplier-和KKT条件能够得到最优值？" class="headerlink" title="二. 为什么拉格朗日乘子法（Lagrange Multiplier) 和KKT条件能够得到最优值？"></a>二. 为什么拉格朗日乘子法（Lagrange Multiplier) 和KKT条件能够得到最优值？</h3><p>为什么要这么求能得到最优值？先说拉格朗日乘子法，设想我们的目标函数 $z = f(x)$, x是向量, z取不同的值，相当于可以投影在x构成的平面（曲面）上，即成为等高线，如下图，目标函数是f(x, y)，这里x是标量，虚线是等高线，现在假设我们的约束 $g(x)=0$，x是向量，在x构成的平面或者曲面上是一条曲线，假设g(x)与等高线相交，交点就是同时满足等式约束条件和目标函数的可行域的值，但肯定不是最优值，因为相交意味着肯定还存在其它的等高线在该条等高线的内部或者外部，使得新的等高线与目标函数的交点的值更大或者更小，只有到等高线与目标函数的曲线相切的时候，可能取得最优值，如下图所示，即等高线和目标函数的曲线在该点的法向量必须有相同方向，所以最优值必须满足：$f(x)的梯度 = a* g(x)$ 的梯度，a是常数，表示左右两边同向。这个等式就是$L(a,x)$ 对参数求导的结果。</p>
<p><img src="/images/blog/%E6%8B%89%E6%A0%BC%E6%9C%97%E6%97%A51.jpg" alt="拉格朗日"></p>
<p>而KKT条件是满足强对偶条件的优化问题的必要条件，可以这样理解：我们要求</p>
<p>$$<br>min f(x), L(a, b, x) = f(x) + a\times g(x) + b\times h(x)，a&gt;=0，<br>$$</p>
<p>我们可以把f(x)写为：$max_{a,b} L(a,b,x)$ 为什么呢？因为 $h(x)=0, g(x)&lt;=0$ ，现在是取 $L(a,b,x)$ 的最大值, $ag(x)\le0$ ,所以 $L(a,b,x)$ 只有在 $a\times g(x)=0$ 的情况下才能取得最大值，否则，就不满足约束条件，因此 $max_{a,b}L(a,b,x)$ 在满足约束条件的情况下就是f(x)，因此我们的目标函数可以写为 $min_xmax_{a,b}L(a,b,x)$ 。如果用对偶表达式： $max_{a,b}min_xL(a,b,x)$ ，由于我们的优化是满足强对偶的（强对偶就是说对偶式子的最优值是等于原问题的最优值的），所以在取得最优值x0的条件下，它满足</p>
<p>$$<br>f(x0) = max_{a,b} min_x  L(a,b,x) = min_x max_{a,b} L(a,b,x) =f(x0)，<br>$$</p>
<p>我们来看看中间两个式子发生了什么事情：</p>
<p>$$<br> f(x0) = max_{a,b} min_x  L(a,b,x) \<br> =  max_{a,b} min_x f(x) + a\times g(x) + b\times h(x) \<br> =  max_{a,b} f(x0)+a\times g(x0)+b\times h(x0) = f(x0)<br>$$</p>
<p>可以看到上述本质上是说 $min_xf(x)+a\times g(x)+b\times h(x)$ 在 $x_0$ 取得了最小值，用fermat定理，即是说对于函数 $f(x)+a\times g(x)+b\times h(x)$，求取导数要等于零，即 $f(x)的梯度+a\times g(x)的梯度+b*h(x)的梯度 = 0$</p>
<p>这就是kkt条件中第一个条件：$L(a, b, x)$ 对 $x$ 求导为零。</p>
<p>而之前说明过，$a*g(x) = 0$ ，这是kkt条件的第2个条件，当然已知的条件 $h(x)=0$ 必须被满足，所有上述说明，满足强对偶条件的优化问题的最优值都必须满足KKT条件，即上述说明的三个条件。可以把KKT条件视为是拉格朗日乘子法的泛化。</p>
<h2 id="适定、超定和欠定方程的概念"><a href="#适定、超定和欠定方程的概念" class="headerlink" title="适定、超定和欠定方程的概念"></a>适定、超定和欠定方程的概念</h2><p>矩阵的每一行代表一个方程，m行代表m个线性联立方程。 n列代表n个变量。如果m是独立方程数，根据m&lt;n、m=n、m&gt;n确定方程是 <code>欠定</code>、<code>适定</code> 还是 <code>超定</code>。</p>
<h3 id="超定方程组"><a href="#超定方程组" class="headerlink" title="超定方程组"></a>超定方程组</h3><p> 即方程个数大于未知量个数的方程组。</p>
<p> 对于方程组Ra=y，R为n×m矩阵，如果R列满秩，且n&gt;m</p>
<p> 超定方程一般是不存在解的矛盾方程。</p>
<p> 例如，如果给定的三点不在一条直线上， 我们将无法得到这样一条直线，使得这条直线同时经过给定这三个点。 也就是说给定的条件（限制）过于严格， 导致解不存在。在实验数据处理和曲线拟合问题中，求解超定方程组非常普遍。比较常用的方法是最小二乘法。形象的说，就是在无法完全满足给定的这些条件的情况下，求一个最接近的解。</p>
<p> 曲线拟合的最小二乘法要解决的问题，实际上就是求以上超定方程组的最小二乘解的问题。</p>
<h3 id="欠定方程组"><a href="#欠定方程组" class="headerlink" title="欠定方程组:"></a>欠定方程组:</h3><p> 即方程个数小于未知量个数的方程组。<br> 对于方程组Ra=y，R为n×m矩阵，且n&lt;m。则方程组有无穷多组解，此时称方程组为欠定方程组。<br> 内点法和梯度投影法是目前解欠定方程组的常用方法。</p>
<h2 id="奇异矩阵"><a href="#奇异矩阵" class="headerlink" title="奇异矩阵"></a>奇异矩阵</h2><p><strong>概念</strong>：奇异矩阵是线性代数的概念，就是对应的行列式等于0的方阵</p>
<p><strong>判断方法</strong>：首先，看这个矩阵是不是方阵（即行数和列数相等的矩阵。若行数和列数不相等，那就谈不上奇异矩阵和非奇异矩阵）。 然后，再看此矩阵的行列式|A|是否等于0，若等于0，称矩阵A为奇异矩阵；若不等于0，称矩阵A为非奇异矩阵。 同时，由|A|≠0可知矩阵A可逆，这样可以得出另外一个重要结论:可逆矩阵就是非奇异矩阵，非奇异矩阵也是可逆矩阵。　如果A为奇异矩阵，则AX=0有无穷解，AX=b有无穷解或者无解。如果A为非奇异矩阵，则AX=0有且只有唯一零解，AX=b有唯一解</p>
<h2 id="多元线性回归参数估计问题"><a href="#多元线性回归参数估计问题" class="headerlink" title="多元线性回归参数估计问题"></a>多元线性回归参数估计问题</h2><h3 id="回归参数的最小二乘估计"><a href="#回归参数的最小二乘估计" class="headerlink" title="回归参数的最小二乘估计"></a>回归参数的最小二乘估计</h3><p>对于含有k个解释变量的多元线性回归模型</p>
<p>$$<br> Y_i=\beta_0+\beta_1X_{1i}+\beta_2X_{2i}+…+\beta_kX_{ki}+\mu_i<br>$$</p>
<p>设 $\bar \beta_0,\bar \beta_2,\bar \beta_2,..\bar \beta_k$ 分别作为参数 $\beta_0,\beta_1,\beta_2,…\beta_k$ 的估计量，得样本回归方程为：</p>
<p>$$<br>   Y_i=\bar \beta_0+\bar \beta_1X_{1i}+\bar \beta_2X_{2i}+…+\bar \beta_kX_{ki}<br>$$</p>
<p>观测值 $Y_i$ 与回归值 $\bar Y_i$ 的残差 $e_i$ 为：</p>
<p> $$<br>  e_i=Y_i-\bar Y_i=Y_i-(\bar \beta_0+\bar \beta_1X_{1i}+\bar \beta_2X_{2i}+…+\bar \beta_kX_{ki})<br> $$</p>
<p>由最小二乘法可知 $\bar \beta_0,\bar \beta_2,\bar \beta_2,..\bar \beta_k$ 应使全部观测值$Y_i$ 与回归值 $\bar Y_i$ 的残差 $e_i$ 的平方和最小，即使</p>
<p>$$<br>  Q(\bar \beta_0,\bar \beta_2,\bar \beta_2,..\bar \beta_k)=\sum e^2_i=\sum(Y-\bar Y_i)^2\<br>  =\sum(Y_i-\bar \beta <em>0-\bar \beta_1X</em>{1i}-\bar \beta_2X_{2i}-…\bar \beta_kX_{ki})<br>$$</p>
<p>取得最小值。令 $Y=(Y_i,Y_1,Y_2,..Y_n),X=(x_0,x_1,…x_n),\bar B=(\bar \beta_0,\bar \beta_2,\bar \beta_2,..\bar \beta_k)$  ,上式可写为</p>
<p>$$<br>Q((\bar \beta_0,\bar \beta_2,\bar \beta_2,..\bar \beta_k)=(Y-\bar BX)^T(Y-\bar BX)\<br>=(Y^TY-Y^TX\bar B-\bar BX^TY+\bar B^TX^TX\bar B)\<br>=Y^TY-2\bar B^TX^TY+\bar B^TX^TX\bar B<br>$$</p>
<p>根据多元函数的极值原理，$Q$ 分别对 $\bar \beta_0,\bar \beta_2,\bar \beta_2,..\bar \beta_k$ 求一阶偏导，并令其等于零，即</p>
<p>$$<br> \frac{\partial Q}{\partial \bar \beta _j}=0(j=0,1,2…k)<br>$$</p>
<p>即 $-X^TY+X^TX\bar B=0$ 。则为向量 $B$ 的估计量为</p>
<p>$$<br>  \bar B= (X^TX)^{-1}X^TY<br>$$</p>
<h2 id="几何概率"><a href="#几何概率" class="headerlink" title="几何概率"></a>几何概率</h2><p>  几何概率(<em>geometric probability</em>)可以用几何方法向某一可度量的区域求得的概率。向区域内投一质点，如果所投的点落在域<em>O</em>中任意区域<em>g</em>内的可能性大小与<em>g</em>的度量成正比，而与<em>g</em>的具体形状无关，则称这个随机试验为几何型随机试验或几何概率。此处的度量就是测度，一维是长度，二维是面积，三维是体积。对于几何概率，若记 $A = 质点落在区域g内$ 这一事件，则其概率定义为</p>
<p>  $$<br>    P(A) = \frac{L(g)}{L(\Omega)}<br>  $$</p>
<p> 其中 $L(g)$ 和 $L(\Omega)$ 分别为<em>g</em>和<em>O</em>的度量。这一类概率是古典概率定义的推广，它保留了等可能性，但将有限个基本事件推广到了无限。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://shartoo.github.com/2019/12/23/2016-10-01-regular-attachment/" data-id="ck4ifp1lv001l2wjef9hxf4q8" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
    
<nav id="article-nav">
  
    <a href="/2019/12/23/2016-10-02-spark-mllib-desciontree/" id="article-nav-newer" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          大数据：spark mllib决策树
        
      </div>
    </a>
  
  
    <a href="/2019/12/23/2016-09-26-pyspark-moiverecommand/" id="article-nav-older" class="article-nav-link-wrap">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">使用pyspark做数据挖掘</div>
    </a>
  
</nav>

  
</article>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/blog/">blog</a></li></ul>
    </div>
  </div>


  
    

  
    
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2019/12/">December 2019</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2019/12/23/template/">博客题目</a>
          </li>
        
          <li>
            <a href="/2019/12/23/hello-world/">Hello World</a>
          </li>
        
          <li>
            <a href="/2019/12/23/2019-11-26-model-pruning/">模型剪枝和优化-torch和Tensorflow为例</a>
          </li>
        
          <li>
            <a href="/2019/12/23/2019-10-28--understand-pytorch/">理解pytorch的计算逻辑</a>
          </li>
        
          <li>
            <a href="/2019/12/23/2019-09-24-outlier-detection/">使用pyod做离群点检测</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2019 shartoo<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  
<link rel="stylesheet" href="/fancybox/jquery.fancybox.css">

  
<script src="/fancybox/jquery.fancybox.pack.js"></script>




<script src="/js/script.js"></script>




  </div>
</body>
</html>